<% unless flash[:notice].blank? %>

<% if flash[:notice].starts_with?('ERROR:') %>
<!-- $FLASH_NOTICE:ERROR -->
<% end %>

<script type="text/javascript">
<%
if flash[:notice].starts_with?('ERROR:')
  msg = flash[:notice]['ERROR:'.length .. -1].gsub("\n", '<br/>').gsub("\"", '\'')
%>
  setTimeout("try{ msg(\"<%= raw(msg) %>\"); }catch(e){}", 100);
<%
elsif flash[:notice].index('INFO:')
  msg = flash[:notice]['INFO:'.length .. -1].gsub("\n", '<br/>').gsub("\"", '\'')
%>
  setTimeout("try{ msg(\"<%= raw(msg) %>\"); }catch(e){}", 100);
<%
else
  msg = flash[:notice].gsub("\n", '<br/>').gsub("\"", '\'')
%>
  setTimeout("try{ tip(\"<%= raw(msg) %>\"); }catch(e){}", 100);
<% end  %>
</script>

<% end %>

<% flash[:notice] = nil %>
